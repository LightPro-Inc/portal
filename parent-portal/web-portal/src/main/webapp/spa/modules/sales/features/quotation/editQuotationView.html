<form role="form" novalidate angular-validator name="addForm" angular-validator-submit="vm.saveItem()">
	<div class="row">
	    <div class="panel panel-primary">
	        <div class="panel-heading clearfix">
	            <h4 class="panel-title pull-left" style="padding-top: 7.5px;">{{vm.title}}</h4>
	        </div>
	        <div class="panel-body">
	            <div ng-if="vm.loadingData">
	                <div class="col-xs-4"></div>
	                <div class="col-xs-4">
	                    <i class="fa fa-refresh fa-5x fa-spin"></i> <label class="label label-primary">Loading metadatas...</label>
	                </div>
	                <div class="col-xs-4"></div>
	            </div>
	            <div ng-if="!vm.loadingMetadatas" class="row">
	                <div class="col-sm-12">	                
	                    <div class="row">
	                    	<div class="form-group form-group-sm col-sm-6">
                   				<label class="control-label col-sm-5" for="customer"><small style="color: red">*</small>&nbsp;&nbsp;Client</label>
				                <div class="col-sm-7">						                	
					                <div class="input-group">
						                <input type="text" class="form-control" id="customer" name="customer" ng-model="vm.item.customer" placeholder="Rechercher un client" required required-message="'Client est un champ obligatoire'" disabled />
                                        <div class="input-group-btn">
                                        	<button ng-if="vm.item.customerId" type="button" class="btn btn-primary" ng-click="vm.modifyCustomer(vm.item.customerId)"><i class="fa fa-edit"></i></button>
                                            <button type="button" class="btn btn-primary" ng-click="vm.searchCustomer()"><i class="glyphicon glyphicon-search"></i></button>
                                        </div>
                                    </div>   
				                </div>
                   			</div>	  
	                    	<div class="form-group form-group-sm col-sm-6">
                    			<label class="control-label col-sm-4" for="orderDate"><small style="color: red">*</small>&nbsp;&nbsp;Date d'édition</label>                                
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="orderDate" name="orderDate" ng-model="vm.item.orderDate" placeholder="Renseigner une date" validate-on="blur" required required-message="'Date d'édition est un champ obligatoire'" uib-datepicker-popup="{{vm.datepicker.format}}" is-open="vm.datepicker.opened" datepicker-options="vm.dateOptions" />
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default" ng-click="vm.openDatePicker($event, prop)"><i class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                    </div>                                    
                                </div>    
                    		</div>    
	                        <div class="form-group form-group-sm col-sm-6">
                    			<label class="control-label col-sm-5" for="paymentCondition"><small style="color: red">*</small>&nbsp;&nbsp;Condition de règlement</label>
				                <div class="col-sm-7">						                	
					                <select class="form-control" id="paymentCondition" name="paymentCondition" ng-model="vm.item.paymentConditionId" required validate-on="blur" required required-message="'Condition de règlement est un champ obligatoire'">
					                	<option value="">-- Choisir une condition --</option>
						                <option ng-selected="vm.item.paymentConditionId == option.id" ng-repeat="option in vm.paymentConditions" value="{{option.id}}">{{option.name}}</option>
						            </select>   
				                </div>
                    		</div>
	                    	<div class="form-group form-group-sm col-sm-6">
                    			<label class="control-label col-sm-4" for="expirationDate"><small style="color: red">*</small>&nbsp;&nbsp;Date d'expiration</label>                                
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="expirationDate" name="expirationDate" ng-model="vm.item.expirationDate" placeholder="Renseigner une date" validate-on="blur" required required-message="'Date expiration est un champ obligatoire'" uib-datepicker-popup="{{vm.datepicker.format}}" is-open="vm.expirationDatepicker.opened" datepicker-options="vm.dateOptions" />
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default" ng-click="vm.openExpirationDatePicker($event, prop)"><i class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                    </div>                                    
                                </div>
                    		</div> 
	                    </div>
		                <div class="row">
		                	<div class="col-md-12">
		                		<div class="pull-right form-group">
			                		<button type="button" class="btn btn-primary btn-sm" ng-click="vm.addNewOrderProduct()">Ajouter</button>
			                	</div>
		                		<table class="table table-bordered table-condensed shortMargin">
		                			<thead>
		                				<tr>
		                					<th>Article</th>
		                					<th>Description</th>
		                					<th>Qté commandée</th>
		                					<th>Prix unitaire</th>
		                					<th>Réduction</th>
		                					<th>Taxes</th>
		                					<th>Sous-total</th>
		                					<th></th>
		                				</tr>		                				
		                			</thead>
		                			<tbody>
		                				<tr ng-repeat="item in vm.item.products" ng-if="!item.deleted">
		                					<td class="shortMargin">{{item.product}}</td>
		                					<td class="shortMargin">{{item.description}}</td>
		                					<td class="shortMargin">{{item.quantity}}</td>
		                					<td class="shortMargin">{{item.unitPrice | number}}</td>
		                					<td class="shortMargin">{{item.reductionAmount | number}}</td>
		                					<td class="shortMargin">{{item.taxesDescription}}</td>
		                					<td class="shortMargin">{{item.totalAmountHt | number}}</td>
		                					<td>
		                						<button type="button" class="btn btn-primary btn-xs" ng-click="vm.modifyOrderProduct(item)"><i class="fa fa-pencil"></i></button>
		                						<button type="button" class="btn btn-danger btn-xs" ng-click="vm.deleteOrderProduct(item)"><i class="fa fa-trash-o"></i></button>
		                					</td>
		                				</tr>
		                				<tr ng-if="vm.item.products.length == 0">
			                                <td colspan="8" class="text-center" style="color: orangered"><i>Aucune ligne d'article.</i></td>
			                            </tr>
		                				<tr>
		                					<td colspan="5" rowspan="3" class="text-center">
		                						<textarea class="form-control" rows="5" cols="8" placeholder="Définir les termes et conditions" ng-model="vm.item.cgv"></textarea>
		                					</td>
			                                <td colspan="3">
			                                	<label class="control-label pull-left">Montant hors-taxe : </label>
			                                	<span class="pull-right">{{vm.getTotalAmountHt() | number}} {{companyCurrency}}</span>
			                                </td>
			                            </tr>
			                            <tr>
			                                <td colspan="3">
			                                	<label class="control-label pull-left">Taxes : </label>
			                                	<span class="pull-right">{{vm.getTotalTaxAmount() | number}} {{companyCurrency}}</span>
			                                </td>
			                            </tr>
			                            <tr>
			                            	<td colspan="3">
			                                	<label class="control-label pull-left">Total : </label>
			                                	<span class="pull-right"><strong>{{vm.getTotalAmountTtc() | number}} {{companyCurrency}}</strong></span>
			                                </td>
			                            </tr>
		                			</tbody>
		                		</table>
		                	</div>
		                </div>
	                </div>
	            </div>
	        </div>
	        <div class="panel-footer clearfix">
	        	<div class="pull-left">
	                <button type="button" class="btn btn-primary" ng-click="vm.markSend()" ng-if="vm.item.statusId == 1">Marquer envoyé</button>
	                <button type="button" class="btn btn-primary" ng-click="vm.markSold()" ng-if="vm.item.statusId == 2">Confirmer la vente</button>
	            </div>
	            <div class="pull-right">
	                <button type="submit" class="btn btn-primary">Enregistrer</button>
                    <button type="button" class="btn btn-default" ng-click="vm.cancel()">Annuler</button>
	            </div>
	        </div>
	    </div>
	</div>
</form>